<?xml version="1.0" encoding="UTF-8"?>

<?import andrew_volostnykh.webrunner.grphics.components.LogArea?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.Tab?>
<?import javafx.scene.control.TabPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.TreeView?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.VBox?>
<?import org.kordamp.ikonli.javafx.FontIcon?>
<VBox xmlns:fx="http://javafx.com/fxml"
      fx:controller="andrew_volostnykh.webrunner.MainController"
      spacing="0"
      prefWidth="900" prefHeight="700">

    <HBox style="-fx-background-color: #2d2d2d;" spacing="10" alignment="CENTER_LEFT"
          onMousePressed="#onTitleBarMousePressed"
          onMouseDragged="#onTitleBarMouseDragged"
          prefHeight="30">
        <Label text="  WebRunner" style="-fx-text-fill: white; -fx-font-size: 14px;"/>

        <Pane HBox.hgrow="ALWAYS"/>

        <Button text="â€”" onAction="#minimizeStage" styleClass="window-button"/>
        <Button text="â" onAction="#maximizeRestoreStage" styleClass="window-button"/>
        <Button text="âœ•" onAction="#closeStage" styleClass="window-close-button"/>
    </HBox>

    <SplitPane
               orientation="HORIZONTAL"
               dividerPositions="0.22"
               VBox.vgrow="ALWAYS">

        <!-- ðŸ“‚ LEFT PANEL: Collections Tree -->
        <VBox spacing="10">

            <HBox spacing="10">
                <Label text="Collections" styleClass="label"/>
                <Pane HBox.hgrow="ALWAYS"/>
                <Button text="+" onAction="#createNewRequestOrFolder"/>
                <Button text="+ Collection" onAction="#createNewRequestOrFolder"/>
            </HBox>

            <TreeView fx:id="collectionTree" VBox.vgrow="ALWAYS"/>
        </VBox>

        <!-- â–¶ RIGHT PANEL: Existing UI -->
        <VBox spacing="10" VBox.vgrow="ALWAYS">

            <!-- Ð’ÐµÑ€Ñ…Ð½Ñ–Ð¹ Ð±Ð»Ð¾Ðº (URL + ÐºÐ½Ð¾Ð¿ÐºÐ°) -->
            <GridPane hgap="10" vgap="5">
                <columnConstraints>
                    <ColumnConstraints minWidth="80"/>
                    <ColumnConstraints hgrow="ALWAYS"/>
                    <ColumnConstraints minWidth="90"/>
                </columnConstraints>

                <ComboBox fx:id="methodCombo" promptText="Method" GridPane.columnIndex="0"/>
                <TextField fx:id="urlField" promptText="https://api.example.com" GridPane.columnIndex="1"/>

                <Button fx:id="sendButton" onAction="#sendRequest" GridPane.columnIndex="2"
                        GridPane.valignment="CENTER">
                    <graphic>
                        <FontIcon iconLiteral="mdi-send:20"/>
                    </graphic>
                </Button>
            </GridPane>

            <!-- ðŸ”¥ SplitPane Ð´Ð»Ñ Body Ñ‚Ð° Response -->
            <SplitPane orientation="VERTICAL" dividerPositions="0.55" VBox.vgrow="ALWAYS">
                <!-- Ð’ÐµÑ€Ñ…Ð½Ñ Ð·Ð¾Ð½Ð° -->
                <VBox spacing="10" VBox.vgrow="ALWAYS">
                    <TabPane VBox.vgrow="ALWAYS">
                        <Tab text="Body">
                            <VBox spacing="5" VBox.vgrow="ALWAYS">
                                <VBox fx:id="bodyContainer" VBox.vgrow="ALWAYS"/>
                            </VBox>
                        </Tab>
                        <Tab text="Headers">
                            <VBox spacing="10" xmlns:fx="http://javafx.com/fxml">
                                <HBox spacing="5">
                                    <TextField fx:id="headerKeyField" promptText="Header Key"/>
                                    <TextField fx:id="headerValueField" promptText="Header Value"/>
                                    <Button text="Add" onAction="#addHeader"/>
                                </HBox>

                                <VBox fx:id="headersList" spacing="5"/>
                            </VBox>
                        </Tab>
                        <Tab text="Testing">
                            <TabPane>
                                <!-- Vars Definition -->
                                <Tab text="Vars Definition">
                                    <VBox fx:id="varsContainer" VBox.vgrow="ALWAYS"/>
                                </Tab>

                                <!-- On Response -->
                                <Tab text="On Response">
                                    <VBox fx:id="afterResponseContainer" VBox.vgrow="ALWAYS"/>
                                </Tab>

                                <!-- Logs -->
                                <Tab text="Logs" onSelectionChanged="#uploadLogs">
                                    <VBox spacing="5" xmlns:fx="http://javafx.com/fxml">
                                        <LogArea fx:id="logsArea" editable="false" wrapText="true" VBox.vgrow="ALWAYS"/>
                                        <Button text="Clear logs" onAction="#clearLogs"/>
                                    </VBox>
                                </Tab>
                            </TabPane>
                        </Tab>
                    </TabPane>
                </VBox>

                <!-- ÐÐ¸Ð¶Ð½Ñ Ð·Ð¾Ð½Ð° (Response) -->
                <VBox spacing="5" VBox.vgrow="ALWAYS">
                    <Label fx:id="statusLabel"/>
                    <TextArea fx:id="responseArea" editable="false" VBox.vgrow="ALWAYS"/>
                </VBox>
            </SplitPane>
        </VBox>
    </SplitPane>
</VBox>